# 비트코인 기초 학습 노트

---

## 1. 비트코인 거래(Transaction)의 3가지 유형

### 1-1. 일반 거래 (단순 송금)
- **입력(Input)**: 하나의 지갑 (송신자)
- **출력(Output)**: 두 개
  - ① 수신자 지갑으로 보내는 금액
  - ② 나(송신자)에게 돌아오는 **거스름돈(Change)**

> 비트코인은 정확한 금액 단위로 쪼갤 수 없기 때문에, 남은 금액은 항상 거스름돈 출력값으로 자신에게 돌아온다.

---

### 1-2. 결합 거래 (Consolidation Transaction)
- **입력(Input)**: 여러 개의 소액 UTXO
- **출력(Output)**: 하나의 큰 UTXO
- **비유**: 동전 여러 개를 지폐 한 장으로 교환하는 행위
- **실행 주체**: 지갑 애플리케이션이 자동으로 처리

---

### 1-3. 배칭 거래 (Transaction Batching)
- **입력(Input)**: 하나의 큰 금액
- **출력(Output)**: 다수의 수신자에게 분배
- **활용 사례**: 기업이 다수의 직원에게 급여를 일괄 지급하는 경우

---

## 2. UTXO (미사용 거래 출력값)

**UTXO = Unspent Transaction Outputs**

- 비트코인은 잔액을 직접 저장하지 않고, **UTXO 목록**으로 관리한다.
- 즉, 비트코인 장부는 "누가 얼마를 가졌다"가 아니라 "아직 사용되지 않은 출력값이 무엇인가"를 기록한다.
- 전체 네트워크의 모든 UTXO를 저장하면 용량이 너무 커지기 때문에, **라이트웨이트 클라이언트(Lightweight Client / SPV)**는 자신과 관련된 UTXO만 추적한다.

---

## 3. 거래 전파 (Transaction Propagation)

1. **자기 완결성**: 거래에 필요한 모든 정보는 거래 데이터 안에 포함되어 있다.
2. **P2P 네트워크**: 중앙 서버 없이 비트코인 참여자 전원에게 전파된다.
3. **연결 방식 무관**: 유선, 와이파이, 모바일 등 어떠한 연결로도 비트코인 노드에 거래를 전송할 수 있다.

---

## 4. 블록 생성과 채굴 (Mining)

### 전체 흐름

```
새로운 거래 발생
      ↓
채굴자가 후보 블록(Candidate Block) 생성
  - 새로운 거래들 포함
  - 추가 데이터 필드 포함 (타임스탬프, 이전 블록 해시 등)
      ↓
논스(Nonce) 값을 변경하며 해시 함수 반복 실행
  - 같은 입력 → 항상 같은 출력
  - 입력이 조금이라도 다르면 → 완전히 다른 출력
      ↓
해시 출력값이 목표값(Target) 이하인가?
      ↓
  YES → 채굴 성공 (복권 당첨)
  NO  → 논스 변경 후 재시도
      ↓
유효한 블록을 네트워크에 전파
      ↓
다른 노드들이 검증 후 블록체인에 추가
```

### 핵심 개념 정리

| 개념 | 설명 |
|------|------|
| **후보 블록** | 채굴자가 만드는 검증 대기 상태의 블록 |
| **해시 함수** | 임의의 입력값을 고정 길이의 출력값으로 변환하는 함수. 입력이 조금만 달라도 출력이 완전히 달라짐 |
| **논스(Nonce)** | 채굴자가 반복 변경하는 숫자값. 유효한 해시를 찾기 위한 "복권 번호" |
| **목표값(Target)** | 프로토콜이 정한 해시 난이도 기준. 해시값이 이 값 이하여야 유효 |
| **작업증명(PoW)** | 유효한 해시를 찾는 이 과정 전체를 의미함 |

---

## 5. 전체 흐름 요약

```
[거래 생성] → [네트워크 전파(P2P)] → [노드 검증] → [후보 블록 포함]
      → [채굴(해시 반복)] → [블록 유효성 확인] → [블록체인 추가]
```

> 거래는 전파만으로는 완결되지 않는다.  
> **채굴되어 블록에 포함**되어야만 비로소 블록체인의 일부가 된다.